{% extends "base.html" %}
{% block content %}
 <h1>HOME Listing </h1>
{# {% include 'include_pages_navbar.html'  %} #}
{# {%  if band.items %}
{% for band in (bands.items %}  #}
{# {{ pagination.info }}
{{ pagination.links }} #}
{% for band in (bands.items if bands.items else bands) %} {# mongoengine queryset objects or pymong cursor (aggregations) #}
<div class="card">
    <div class="card-img" style="background-image: url({{ url_for('static_media', filename='band_profile_pics/'+band.media_assets.featured_image if band.media_assets else 'band_profile_pics/defaultband.jpg' ) }})">
    <a href="{{ url_for('public.band_detail', bname=band.band_name)}}"></a>
    </div>
    <div class="card-content">
        <p class="headline-eyebrow">{{ band.description }}</p>    
        <h2 class="headline"><a href="{{ url_for('public.band_detail', bname=band.band_name)}}">{{ band.band_name }}</a></h2>
        <p class="headline--strapline">{{ band.strapline }}</p>
        <p>{{ band.profile|truncate(80, False) }}</p>
        <p>{{ band.hometown.town }}, Co.{{ band.hometown.county }}</p>
        <ul class="genre-tags">
            {% for genre in band.genres[0:4] %}
            <li>{{ genre }}</li>
            {% endfor %}
        </ul>
        <div class="card-footer">
            <ul>
                <li><a href="{{ url_for('public.band_detail', bname=band.band_name)}}" class="btn btn-subform add">More Info</a></li>
            {% if current_user.is_authenticated %} {# and OWNS bands = session ? #}
                <li class="edit"><a href="{{ url_for('manage.update_band_profile', bname=band.band_name ) }}" class="btn btn-subform add">Edit</a></li>
            {% else %}

            {% endif %}
            </ul>
        </div>
    </div>
</div>
{% endfor %}
{# {% for dict_item in request.args %} #}
   {% for key, value in request.args.items() %}
      <h1>Key: {{key}}</h1>
      <h2>Value: {{value}}</h2>
   {% endfor %}

{# {{ search }} #}
{# {% endfor %} #}
<footer class="pages">
<nav class="pages__pagelinks"><ul>
{% if alphabet %}
    {% for letter in alphabet %}
    <li><a class="btn" href="{{ url_for('public.a2z', letter=letter ) }}">{{ letter }}</a></li>
    {% endfor %}
{% endif %}

{# pagination nav macro #}
    {% if bands.iter_pages %}
    {% for page_num in bands.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
        {% if page_num %}
            {% if 'letter' in request.args %}
            <li><a class="btn btn--pagelink {{ 'btn--pagelink--current' if bands.page == page_num }}" href="{{ url_for('public.a2z', letter=request.args.get('letter'),  page=page_num) if request.args.get('letter') else url_for('public.home', page=page_num)  }}">{{ page_num }}</a></li>
            {% elif 'genres' in request.args  %}
            <li><a class="btn btn--pagelink {{ 'btn--pagelink--current' if bands.page == page_num }}" href="/search?{{ search+page_num|string }}">{{ page_num }}</a></li>
            {% endif %}
        {% else %}
        ...
        {% endif %}
    {% endfor %}
    {% endif %}

</ul></nav>
</footer>
{% endblock content %}